<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iris 쿼드콥터 SDF 모델 분석 - Gazebo 시뮬레이션</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --text-primary: #1a1a1a;
            --text-secondary: #4a4a4a;
            --text-muted: #6b6b6b;
            --bg-white: #ffffff;
            --bg-light: #f8f9fa;
            --bg-code: #f4f4f5;
            --border-color: #e5e5e5;
            --accent-blue: #2563eb;
            --accent-green: #059669;
            --accent-orange: #d97706;
            --accent-purple: #7c3aed;
            --accent-red: #dc2626;
            --accent-cyan: #0891b2;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 16px;
            line-height: 1.8;
            color: var(--text-primary);
            background: var(--bg-white);
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 920px;
            margin: 0 auto;
            padding: 60px 40px;
        }

        header {
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 40px;
            margin-bottom: 50px;
        }

        header h1 {
            font-size: 2.2rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        header .subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        header .meta {
            margin-top: 20px;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .toc {
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            padding: 30px 35px;
            margin-bottom: 50px;
        }

        .toc h2 {
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 20px;
        }

        .toc ol {
            list-style: none;
            counter-reset: toc-counter;
        }

        .toc > ol > li {
            counter-increment: toc-counter;
            margin-bottom: 12px;
        }

        .toc > ol > li::before {
            content: counter(toc-counter, decimal-leading-zero) ".";
            font-weight: 500;
            color: var(--text-muted);
            margin-right: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }

        .toc a {
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 400;
            transition: color 0.15s;
        }

        .toc a:hover {
            color: var(--accent-blue);
        }

        .toc ol ol {
            margin-left: 35px;
            margin-top: 8px;
        }

        .toc ol ol li {
            margin-bottom: 6px;
            font-size: 0.95rem;
            color: var(--text-secondary);
        }

        section {
            margin-bottom: 60px;
        }

        h2 {
            font-size: 1.6rem;
            font-weight: 600;
            margin-bottom: 25px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--text-primary);
            letter-spacing: -0.01em;
        }

        h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 35px 0 18px 0;
            color: var(--text-primary);
        }

        h4 {
            font-size: 1.05rem;
            font-weight: 600;
            margin: 25px 0 12px 0;
            color: var(--text-secondary);
        }

        p {
            margin-bottom: 16px;
            color: var(--text-secondary);
        }

        pre {
            background: var(--bg-code);
            border: 1px solid var(--border-color);
            padding: 20px 24px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
        }

        code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9em;
            background: var(--bg-code);
            padding: 2px 6px;
            border-radius: 3px;
        }

        pre code {
            background: none;
            padding: 0;
        }

        .tag { color: var(--accent-red); }
        .attr { color: var(--accent-purple); }
        .value { color: var(--accent-green); }
        .comment { color: var(--text-muted); font-style: italic; }

        .info-box {
            padding: 20px 24px;
            margin: 24px 0;
            border-left: 3px solid;
        }

        .info-box.concept {
            background: #f0f9ff;
            border-color: var(--accent-blue);
        }

        .info-box.warning {
            background: #fffbeb;
            border-color: var(--accent-orange);
        }

        .info-box.important {
            background: #fef2f2;
            border-color: var(--accent-red);
        }

        .info-box.tip {
            background: #f0fdf4;
            border-color: var(--accent-green);
        }

        .info-box-title {
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.03em;
            margin-bottom: 8px;
        }

        .concept .info-box-title { color: var(--accent-blue); }
        .warning .info-box-title { color: var(--accent-orange); }
        .important .info-box-title { color: var(--accent-red); }
        .tip .info-box-title { color: var(--accent-green); }

        .diagram {
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            padding: 25px;
            margin: 24px 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            line-height: 1.4;
            overflow-x: auto;
            white-space: pre;
        }

        .diagram-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 24px 0;
            font-size: 0.95rem;
        }

        th, td {
            padding: 12px 16px;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
            color: var(--text-primary);
        }

        td {
            color: var(--text-secondary);
        }

        td code {
            font-size: 0.85em;
        }

        ul, ol {
            margin: 16px 0;
            padding-left: 24px;
        }

        li {
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        li strong {
            color: var(--text-primary);
        }

        .param-list {
            margin: 16px 0;
        }

        .param-item {
            display: grid;
            grid-template-columns: 180px 100px 1fr;
            gap: 12px;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
            align-items: start;
        }

        .param-item:last-child {
            border-bottom: none;
        }

        .param-name {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
            color: var(--accent-purple);
            font-size: 0.9rem;
        }

        .param-type {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .param-desc {
            color: var(--text-secondary);
        }

        .hierarchy {
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            padding: 20px 25px;
            margin: 20px 0;
        }

        .hierarchy-item {
            margin: 8px 0;
            padding-left: 20px;
            border-left: 2px solid var(--border-color);
        }

        .hierarchy-item.level-0 {
            padding-left: 0;
            border-left: none;
            font-weight: 600;
        }

        .hierarchy-item.level-1 { margin-left: 20px; }
        .hierarchy-item.level-2 { margin-left: 40px; }
        .hierarchy-item.level-3 { margin-left: 60px; }

        .link-type {
            display: inline-block;
            font-size: 0.75rem;
            padding: 2px 8px;
            border-radius: 3px;
            margin-left: 8px;
            font-weight: 500;
        }

        .link-type.base { background: #dbeafe; color: #1e40af; }
        .link-type.sensor { background: #dcfce7; color: #166534; }
        .link-type.rotor { background: #fef3c7; color: #92400e; }
        .link-type.joint { background: #f3e8ff; color: #6b21a8; }

        .formula {
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            padding: 20px 24px;
            margin: 20px 0;
            text-align: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
        }

        .formula-label {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 10px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .grid-2 > div {
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            padding: 20px;
        }

        .grid-2 h5 {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        footer {
            margin-top: 80px;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        @media print {
            .container {
                max-width: 100%;
                padding: 20px;
            }
            
            pre, .diagram {
                page-break-inside: avoid;
            }
        }

        @media (max-width: 768px) {
            .param-item {
                grid-template-columns: 1fr;
                gap: 4px;
            }
            
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Iris 쿼드콥터 SDF 모델 분석</h1>
            <p class="subtitle">Gazebo 시뮬레이션을 위한 드론 모델 정의 파일 상세 해설</p>
            <p class="meta">대상: 학부 3학년 | 분야: 로보틱스, 시뮬레이션</p>
        </header>

        <!-- Table of Contents -->
        <nav class="toc">
            <h2>목차</h2>
            <ol>
                <li><a href="#overview">SDF 파일 개요</a></li>
                <li><a href="#structure">모델 구조</a></li>
                <li><a href="#base-link">Base Link (드론 본체)</a></li>
                <li><a href="#camera">FPV 카메라</a></li>
                <li><a href="#imu">IMU 센서</a></li>
                <li><a href="#rotors">로터 시스템</a></li>
                <li><a href="#plugins">Gazebo 플러그인</a>
                    <ol>
                        <li><a href="#motor-plugin">모터 모델 플러그인</a></li>
                        <li><a href="#sensor-plugins">센서 플러그인</a></li>
                        <li><a href="#mavlink-plugin">MAVLink 인터페이스</a></li>
                    </ol>
                </li>
                <li><a href="#physics">물리 파라미터 해석</a></li>
            </ol>
        </nav>

        <!-- Section 1: Overview -->
        <section id="overview">
            <h2>01. SDF 파일 개요</h2>
            
            <h3>SDF (Simulation Description Format)란?</h3>
            <p>SDF는 Gazebo 시뮬레이터에서 사용하는 로봇 및 환경 정의 형식입니다. XML 기반으로 로봇의 물리적 특성, 센서, 외관 등을 정의합니다.</p>

            <div class="info-box concept">
                <div class="info-box-title">SDF vs URDF</div>
                <p><strong>URDF</strong>: ROS 표준 로봇 정의 형식. 단순한 로봇 구조 정의에 적합</p>
                <p><strong>SDF</strong>: Gazebo 네이티브 형식. 더 풍부한 물리 시뮬레이션, 센서, 플러그인 지원</p>
                <p>이 파일은 PX4 SITL(Software-In-The-Loop) 시뮬레이션을 위한 Iris 쿼드콥터 모델입니다.</p>
            </div>

            <h3>파일 기본 구조</h3>
            <pre><code><span class="tag">&lt;sdf</span> <span class="attr">version</span>=<span class="value">'1.6'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;model</span> <span class="attr">name</span>=<span class="value">'iris'</span><span class="tag">&gt;</span>
    <span class="comment">&lt;!-- 링크 정의 (물리적 바디) --&gt;</span>
    <span class="tag">&lt;link</span> <span class="attr">name</span>=<span class="value">'base_link'</span><span class="tag">&gt;</span>...<span class="tag">&lt;/link&gt;</span>
    
    <span class="comment">&lt;!-- 조인트 정의 (링크 간 연결) --&gt;</span>
    <span class="tag">&lt;joint</span> <span class="attr">name</span>=<span class="value">'...'</span> <span class="attr">type</span>=<span class="value">'...'</span><span class="tag">&gt;</span>...<span class="tag">&lt;/joint&gt;</span>
    
    <span class="comment">&lt;!-- 플러그인 (시뮬레이션 기능 확장) --&gt;</span>
    <span class="tag">&lt;plugin</span> <span class="attr">name</span>=<span class="value">'...'</span> <span class="attr">filename</span>=<span class="value">'...'</span><span class="tag">&gt;</span>...<span class="tag">&lt;/plugin&gt;</span>
  <span class="tag">&lt;/model&gt;</span>
<span class="tag">&lt;/sdf&gt;</span></code></pre>

            <h3>Iris 드론 사양</h3>
            <table>
                <thead>
                    <tr>
                        <th>항목</th>
                        <th>값</th>
                        <th>설명</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>모델명</td>
                        <td>3DR Iris</td>
                        <td>PX4 기본 시뮬레이션 드론</td>
                    </tr>
                    <tr>
                        <td>타입</td>
                        <td>쿼드콥터 (X 배열)</td>
                        <td>4개 로터, 대각선 배치</td>
                    </tr>
                    <tr>
                        <td>총 질량</td>
                        <td>1.5 kg</td>
                        <td>본체만 (로터 제외)</td>
                    </tr>
                    <tr>
                        <td>크기</td>
                        <td>0.47 × 0.47 × 0.11 m</td>
                        <td>충돌 박스 기준</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Section 2: Structure -->
        <section id="structure">
            <h2>02. 모델 구조</h2>

            <h3>링크-조인트 계층 구조</h3>
            <div class="diagram">
<div class="diagram-title">Iris 모델 트리 구조</div>
iris (model)
│
├── base_link ─────────────────────── 드론 본체 (루트 링크)
│   │
│   ├── fpv_cam_link ◀── fpv_cam_joint (fixed)
│   │   └── [카메라 센서]
│   │
│   ├── /imu_link ◀── /imu_joint (revolute, 고정)
│   │   └── [IMU 센서]
│   │
│   ├── rotor_0 ◀── rotor_0_joint (revolute)
│   │   └── 우측 전방 로터 (CCW)
│   │
│   ├── rotor_1 ◀── rotor_1_joint (revolute)
│   │   └── 좌측 후방 로터 (CCW)
│   │
│   ├── rotor_2 ◀── rotor_2_joint (revolute)
│   │   └── 좌측 전방 로터 (CW)
│   │
│   ├── rotor_3 ◀── rotor_3_joint (revolute)
│   │   └── 우측 후방 로터 (CW)
│   │
│   └── gps0::link ◀── gps0_joint (fixed)
│       └── [GPS 센서]
│
└── [플러그인들]
    ├── 모터 모델 (×4)
    ├── IMU, 자력계, 기압계
    ├── MAVLink 인터페이스
    └── Ground Truth</div>

            <h3>조인트 타입 설명</h3>
            <table>
                <thead>
                    <tr>
                        <th>타입</th>
                        <th>자유도</th>
                        <th>용도</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>fixed</code></td>
                        <td>0 DOF</td>
                        <td>고정 연결 (카메라, GPS)</td>
                    </tr>
                    <tr>
                        <td><code>revolute</code></td>
                        <td>1 DOF (회전)</td>
                        <td>로터 회전, IMU 마운트</td>
                    </tr>
                    <tr>
                        <td><code>continuous</code></td>
                        <td>1 DOF (무한 회전)</td>
                        <td>휠 등 (이 모델에서 미사용)</td>
                    </tr>
                    <tr>
                        <td><code>prismatic</code></td>
                        <td>1 DOF (직선)</td>
                        <td>선형 액추에이터 (미사용)</td>
                    </tr>
                </tbody>
            </table>

            <h3>로터 배치 (X 배열)</h3>
            <div class="diagram">
<div class="diagram-title">쿼드콥터 로터 배치 (위에서 본 모습)</div>
                      전방 (+X)
                         ↑
                         │
         rotor_2         │         rotor_0
        (좌측 전방)      │        (우측 전방)
           CW ⟳         │          ⟲ CCW
      (+0.13, +0.22)     │     (+0.13, -0.22)
             ╲           │           ╱
              ╲          │          ╱
               ╲    ┌────┴────┐    ╱
                ╲   │         │   ╱
     ←───────────╲──│  본체   │──╱───────────→ 우측 (+Y)
                 ╱  │         │  ╲
                ╱   └────┬────┘   ╲
               ╱         │         ╲
              ╱          │          ╲
             ╱           │           ╲
           CCW ⟲        │         ⟳ CW
      (-0.13, +0.20)     │     (-0.13, -0.20)
         rotor_1         │         rotor_3
        (좌측 후방)      │        (우측 후방)
                         │
                         ↓
                      후방 (-X)

[회전 방향]
• CCW (Counter-Clockwise): 반시계 방향 - rotor_0, rotor_1
• CW (Clockwise): 시계 방향 - rotor_2, rotor_3

[토크 균형]
대각선 로터는 같은 방향으로 회전 → Yaw 토크 상쇄</div>
        </section>

        <!-- Section 3: Base Link -->
        <section id="base-link">
            <h2>03. Base Link (드론 본체)</h2>

            <p><code>base_link</code>는 드론의 메인 바디로, 모든 다른 링크의 부모 역할을 합니다.</p>

            <h3>관성 특성 (Inertial)</h3>
            <pre><code><span class="tag">&lt;inertial&gt;</span>
  <span class="tag">&lt;pose&gt;</span>0 0 0 0 0 0<span class="tag">&lt;/pose&gt;</span>  <span class="comment">&lt;!-- 질량 중심 위치 --&gt;</span>
  <span class="tag">&lt;mass&gt;</span>1.5<span class="tag">&lt;/mass&gt;</span>           <span class="comment">&lt;!-- 질량 [kg] --&gt;</span>
  <span class="tag">&lt;inertia&gt;</span>
    <span class="tag">&lt;ixx&gt;</span>0.029125<span class="tag">&lt;/ixx&gt;</span>     <span class="comment">&lt;!-- X축 관성 모멘트 --&gt;</span>
    <span class="tag">&lt;ixy&gt;</span>0<span class="tag">&lt;/ixy&gt;</span>             <span class="comment">&lt;!-- 관성 곱 (대칭이면 0) --&gt;</span>
    <span class="tag">&lt;ixz&gt;</span>0<span class="tag">&lt;/ixz&gt;</span>
    <span class="tag">&lt;iyy&gt;</span>0.029125<span class="tag">&lt;/iyy&gt;</span>     <span class="comment">&lt;!-- Y축 관성 모멘트 --&gt;</span>
    <span class="tag">&lt;iyz&gt;</span>0<span class="tag">&lt;/iyz&gt;</span>
    <span class="tag">&lt;izz&gt;</span>0.055225<span class="tag">&lt;/izz&gt;</span>     <span class="comment">&lt;!-- Z축 관성 모멘트 --&gt;</span>
  <span class="tag">&lt;/inertia&gt;</span>
<span class="tag">&lt;/inertial&gt;</span></code></pre>

            <div class="info-box concept">
                <div class="info-box-title">관성 텐서 (Inertia Tensor)</div>
                <p>3D 강체의 회전 저항을 나타내는 3×3 대칭 행렬입니다.</p>
            </div>

            <div class="formula">
                    ┌ I<sub>xx</sub>  I<sub>xy</sub>  I<sub>xz</sub> ┐       ┌ 0.029125    0        0     ┐
                I = │ I<sub>xy</sub>  I<sub>yy</sub>  I<sub>yz</sub> │   =   │    0     0.029125    0     │
                    └ I<sub>xz</sub>  I<sub>yz</sub>  I<sub>zz</sub> ┘       └    0        0     0.055225 ┘
                <div class="formula-label">단위: kg·m²</div>
            </div>

            <p><strong>물리적 의미:</strong></p>
            <ul>
                <li><strong>I<sub>xx</sub> = I<sub>yy</sub></strong>: Roll과 Pitch 축의 관성이 동일 → 대칭적인 드론 형상</li>
                <li><strong>I<sub>zz</sub> > I<sub>xx</sub></strong>: Yaw 축 관성이 더 큼 → 납작한 형태 (회전판과 유사)</li>
                <li><strong>I<sub>xy</sub> = I<sub>xz</sub> = I<sub>yz</sub> = 0</strong>: 주축과 좌표축 일치 → 대칭 형상</li>
            </ul>

            <h3>충돌 형상 (Collision)</h3>
            <pre><code><span class="tag">&lt;collision</span> <span class="attr">name</span>=<span class="value">'base_link_inertia_collision'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;geometry&gt;</span>
    <span class="tag">&lt;box&gt;</span>
      <span class="tag">&lt;size&gt;</span>0.47 0.47 0.11<span class="tag">&lt;/size&gt;</span>  <span class="comment">&lt;!-- 가로 × 세로 × 높이 [m] --&gt;</span>
    <span class="tag">&lt;/box&gt;</span>
  <span class="tag">&lt;/geometry&gt;</span>
  <span class="tag">&lt;surface&gt;</span>
    <span class="tag">&lt;contact&gt;</span>
      <span class="tag">&lt;ode&gt;</span>
        <span class="tag">&lt;min_depth&gt;</span>0.001<span class="tag">&lt;/min_depth&gt;</span>  <span class="comment">&lt;!-- 최소 침투 깊이 --&gt;</span>
        <span class="tag">&lt;max_vel&gt;</span>0<span class="tag">&lt;/max_vel&gt;</span>          <span class="comment">&lt;!-- 접촉 시 최대 속도 --&gt;</span>
      <span class="tag">&lt;/ode&gt;</span>
    <span class="tag">&lt;/contact&gt;</span>
  <span class="tag">&lt;/surface&gt;</span>
<span class="tag">&lt;/collision&gt;</span></code></pre>

            <div class="info-box tip">
                <div class="info-box-title">Collision vs Visual</div>
                <p><strong>Collision</strong>: 물리 엔진이 충돌 감지에 사용. 단순한 형상 (박스, 실린더) 권장</p>
                <p><strong>Visual</strong>: 렌더링에만 사용. 복잡한 메쉬 가능 (iris.stl)</p>
                <p>복잡한 메쉬를 충돌에 사용하면 시뮬레이션 성능이 크게 저하됩니다.</p>
            </div>

            <h3>시각적 형상 (Visual)</h3>
            <pre><code><span class="tag">&lt;visual</span> <span class="attr">name</span>=<span class="value">'base_link_inertia_visual'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;geometry&gt;</span>
    <span class="tag">&lt;mesh&gt;</span>
      <span class="tag">&lt;scale&gt;</span>1 1 1<span class="tag">&lt;/scale&gt;</span>
      <span class="tag">&lt;uri&gt;</span>model://iris/meshes/iris.stl<span class="tag">&lt;/uri&gt;</span>
    <span class="tag">&lt;/mesh&gt;</span>
  <span class="tag">&lt;/geometry&gt;</span>
  <span class="tag">&lt;material&gt;</span>
    <span class="tag">&lt;script&gt;</span>
      <span class="tag">&lt;name&gt;</span>Gazebo/DarkGrey<span class="tag">&lt;/name&gt;</span>  <span class="comment">&lt;!-- 사전 정의된 재질 --&gt;</span>
    <span class="tag">&lt;/script&gt;</span>
  <span class="tag">&lt;/material&gt;</span>
<span class="tag">&lt;/visual&gt;</span></code></pre>
        </section>

        <!-- Section 4: Camera -->
        <section id="camera">
            <h2>04. FPV 카메라</h2>

            <p>드론 하단에 장착된 FPV(First Person View) 카메라로, ArUco 마커 검출에 사용됩니다.</p>

            <h3>카메라 링크 위치</h3>
            <pre><code><span class="tag">&lt;link</span> <span class="attr">name</span>=<span class="value">'fpv_cam_link'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;pose&gt;</span>0 0 -0.02 0 1.5707963 0<span class="tag">&lt;/pose&gt;</span>
  <span class="comment">&lt;!--    X Y Z    Roll Pitch Yaw --&gt;</span>
  <span class="comment">&lt;!--            (라디안 단위)    --&gt;</span></code></pre>

            <div class="info-box concept">
                <div class="info-box-title">Pose 해석</div>
                <p><strong>위치</strong>: (0, 0, -0.02) → 드론 중심에서 2cm 아래</p>
                <p><strong>자세</strong>: Pitch = 1.5707963 rad = 90° → 카메라가 아래를 향함</p>
            </div>

            <h3>카메라 센서 파라미터</h3>
            <pre><code><span class="tag">&lt;sensor</span> <span class="attr">name</span>=<span class="value">'fpv_camera'</span> <span class="attr">type</span>=<span class="value">'camera'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;camera</span> <span class="attr">name</span>=<span class="value">'__default__'</span><span class="tag">&gt;</span>
    <span class="tag">&lt;horizontal_fov&gt;</span>1.047<span class="tag">&lt;/horizontal_fov&gt;</span>  <span class="comment">&lt;!-- 수평 시야각 [rad] ≈ 60° --&gt;</span>
    <span class="tag">&lt;image&gt;</span>
      <span class="tag">&lt;width&gt;</span>320<span class="tag">&lt;/width&gt;</span>     <span class="comment">&lt;!-- 이미지 너비 [픽셀] --&gt;</span>
      <span class="tag">&lt;height&gt;</span>240<span class="tag">&lt;/height&gt;</span>  <span class="comment">&lt;!-- 이미지 높이 [픽셀] --&gt;</span>
    <span class="tag">&lt;/image&gt;</span>
    <span class="tag">&lt;clip&gt;</span>
      <span class="tag">&lt;near&gt;</span>0.1<span class="tag">&lt;/near&gt;</span>    <span class="comment">&lt;!-- 최소 가시 거리 [m] --&gt;</span>
      <span class="tag">&lt;far&gt;</span>100<span class="tag">&lt;/far&gt;</span>      <span class="comment">&lt;!-- 최대 가시 거리 [m] --&gt;</span>
    <span class="tag">&lt;/clip&gt;</span>
  <span class="tag">&lt;/camera&gt;</span>
  <span class="tag">&lt;always_on&gt;</span>1<span class="tag">&lt;/always_on&gt;</span>
  <span class="tag">&lt;update_rate&gt;</span>30<span class="tag">&lt;/update_rate&gt;</span>  <span class="comment">&lt;!-- 프레임레이트 [Hz] --&gt;</span>
<span class="tag">&lt;/sensor&gt;</span></code></pre>

            <h4>카메라 사양 요약</h4>
            <table>
                <thead>
                    <tr>
                        <th>파라미터</th>
                        <th>값</th>
                        <th>설명</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>해상도</td>
                        <td>320 × 240</td>
                        <td>QVGA 해상도</td>
                    </tr>
                    <tr>
                        <td>수평 FOV</td>
                        <td>60° (1.047 rad)</td>
                        <td>일반적인 드론 카메라</td>
                    </tr>
                    <tr>
                        <td>프레임레이트</td>
                        <td>30 Hz</td>
                        <td>초당 30프레임</td>
                    </tr>
                    <tr>
                        <td>가시 범위</td>
                        <td>0.1 ~ 100 m</td>
                        <td>클리핑 평면</td>
                    </tr>
                </tbody>
            </table>

            <h3>ROS 카메라 플러그인</h3>
            <pre><code><span class="tag">&lt;plugin</span> <span class="attr">name</span>=<span class="value">'camera_plugin'</span> <span class="attr">filename</span>=<span class="value">'libgazebo_ros_camera.so'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;cameraName&gt;</span>usb_cam<span class="tag">&lt;/cameraName&gt;</span>
  <span class="tag">&lt;imageTopicName&gt;</span>image_raw<span class="tag">&lt;/imageTopicName&gt;</span>
  <span class="tag">&lt;cameraInfoTopicName&gt;</span>camera_info<span class="tag">&lt;/cameraInfoTopicName&gt;</span>
  <span class="tag">&lt;updateRate&gt;</span>30.0<span class="tag">&lt;/updateRate&gt;</span>
  <span class="tag">&lt;frameName&gt;</span>/robot_camera_link<span class="tag">&lt;/frameName&gt;</span>
  
  <span class="comment">&lt;!-- 카메라 내부 파라미터 --&gt;</span>
  <span class="tag">&lt;CxPrime&gt;</span>320.5<span class="tag">&lt;/CxPrime&gt;</span>  <span class="comment">&lt;!-- 주점 X (rectified) --&gt;</span>
  <span class="tag">&lt;Cx&gt;</span>320.5<span class="tag">&lt;/Cx&gt;</span>            <span class="comment">&lt;!-- 주점 X --&gt;</span>
  <span class="tag">&lt;Cy&gt;</span>240.5<span class="tag">&lt;/Cy&gt;</span>            <span class="comment">&lt;!-- 주점 Y --&gt;</span>
  <span class="tag">&lt;focalLength&gt;</span>277.191356<span class="tag">&lt;/focalLength&gt;</span>  <span class="comment">&lt;!-- 초점 거리 [픽셀] --&gt;</span>
  
  <span class="comment">&lt;!-- 왜곡 계수 (이상적 카메라: 모두 0) --&gt;</span>
  <span class="tag">&lt;distortionK1&gt;</span>0.0<span class="tag">&lt;/distortionK1&gt;</span>
  <span class="tag">&lt;distortionK2&gt;</span>0.0<span class="tag">&lt;/distortionK2&gt;</span>
  <span class="tag">&lt;distortionK3&gt;</span>0.0<span class="tag">&lt;/distortionK3&gt;</span>
  <span class="tag">&lt;distortionT1&gt;</span>0.0<span class="tag">&lt;/distortionT1&gt;</span>
  <span class="tag">&lt;distortionT2&gt;</span>0.0<span class="tag">&lt;/distortionT2&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>

            <div class="info-box tip">
                <div class="info-box-title">발행되는 ROS 토픽</div>
                <p><code>/iris/usb_cam/image_raw</code> — 원본 이미지</p>
                <p><code>/iris/usb_cam/image_raw/compressed</code> — JPEG 압축 이미지</p>
                <p><code>/iris/usb_cam/camera_info</code> — 카메라 캘리브레이션 정보</p>
            </div>

            <h4>카메라 내부 파라미터 행렬</h4>
            <div class="formula">
                    ┌ f<sub>x</sub>   0   c<sub>x</sub> ┐     ┌ 277.19    0    320.5 ┐
                K = │  0   f<sub>y</sub>  c<sub>y</sub> │  =  │   0    277.19  240.5 │
                    └  0    0    1  ┘     └   0       0      1   ┘
                <div class="formula-label">단위: 픽셀</div>
            </div>
        </section>

        <!-- Section 5: IMU -->
        <section id="imu">
            <h2>05. IMU 센서</h2>

            <p>IMU(Inertial Measurement Unit)는 가속도계와 자이로스코프를 포함하여 드론의 자세와 각속도를 측정합니다.</p>

            <h3>IMU 링크</h3>
            <pre><code><span class="tag">&lt;link</span> <span class="attr">name</span>=<span class="value">'/imu_link'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;pose&gt;</span>0 0 0.02 0 0 0<span class="tag">&lt;/pose&gt;</span>  <span class="comment">&lt;!-- 드론 중심에서 2cm 위 --&gt;</span>
  <span class="tag">&lt;inertial&gt;</span>
    <span class="tag">&lt;mass&gt;</span>0.015<span class="tag">&lt;/mass&gt;</span>  <span class="comment">&lt;!-- 15g --&gt;</span>
    <span class="tag">&lt;inertia&gt;</span>
      <span class="tag">&lt;ixx&gt;</span>1e-05<span class="tag">&lt;/ixx&gt;</span>  <span class="comment">&lt;!-- 매우 작은 관성 --&gt;</span>
      <span class="tag">&lt;iyy&gt;</span>1e-05<span class="tag">&lt;/iyy&gt;</span>
      <span class="tag">&lt;izz&gt;</span>1e-05<span class="tag">&lt;/izz&gt;</span>
    <span class="tag">&lt;/inertia&gt;</span>
  <span class="tag">&lt;/inertial&gt;</span>
<span class="tag">&lt;/link&gt;</span></code></pre>

            <h3>IMU 조인트</h3>
            <pre><code><span class="tag">&lt;joint</span> <span class="attr">name</span>=<span class="value">'/imu_joint'</span> <span class="attr">type</span>=<span class="value">'revolute'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;child&gt;</span>/imu_link<span class="tag">&lt;/child&gt;</span>
  <span class="tag">&lt;parent&gt;</span>base_link<span class="tag">&lt;/parent&gt;</span>
  <span class="tag">&lt;axis&gt;</span>
    <span class="tag">&lt;xyz&gt;</span>1 0 0<span class="tag">&lt;/xyz&gt;</span>  <span class="comment">&lt;!-- X축 기준 회전 --&gt;</span>
    <span class="tag">&lt;limit&gt;</span>
      <span class="tag">&lt;lower&gt;</span>0<span class="tag">&lt;/lower&gt;</span>   <span class="comment">&lt;!-- 하한 = 상한 = 0 --&gt;</span>
      <span class="tag">&lt;upper&gt;</span>0<span class="tag">&lt;/upper&gt;</span>   <span class="comment">&lt;!-- → 실질적으로 고정 --&gt;</span>
      <span class="tag">&lt;effort&gt;</span>0<span class="tag">&lt;/effort&gt;</span>
      <span class="tag">&lt;velocity&gt;</span>0<span class="tag">&lt;/velocity&gt;</span>
    <span class="tag">&lt;/limit&gt;</span>
  <span class="tag">&lt;/axis&gt;</span>
<span class="tag">&lt;/joint&gt;</span></code></pre>

            <div class="info-box warning">
                <div class="info-box-title">왜 revolute 조인트를 사용하나요?</div>
                <p><code>revolute</code> 조인트에 limit lower=upper=0을 설정하면 실질적으로 <code>fixed</code>처럼 동작합니다.</p>
                <p>이는 일부 플러그인 호환성이나 시뮬레이션 안정성을 위한 기법입니다.</p>
            </div>

            <h3>IMU 플러그인 노이즈 모델</h3>
            <pre><code><span class="tag">&lt;plugin</span> <span class="attr">name</span>=<span class="value">'rotors_gazebo_imu_plugin'</span> <span class="attr">filename</span>=<span class="value">'libgazebo_imu_plugin.so'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;linkName&gt;</span>/imu_link<span class="tag">&lt;/linkName&gt;</span>
  <span class="tag">&lt;imuTopic&gt;</span>/imu<span class="tag">&lt;/imuTopic&gt;</span>
  
  <span class="comment">&lt;!-- 자이로스코프 노이즈 파라미터 --&gt;</span>
  <span class="tag">&lt;gyroscopeNoiseDensity&gt;</span>0.00018665<span class="tag">&lt;/gyroscopeNoiseDensity&gt;</span>
  <span class="tag">&lt;gyroscopeRandomWalk&gt;</span>3.8785e-05<span class="tag">&lt;/gyroscopeRandomWalk&gt;</span>
  <span class="tag">&lt;gyroscopeBiasCorrelationTime&gt;</span>1000.0<span class="tag">&lt;/gyroscopeBiasCorrelationTime&gt;</span>
  <span class="tag">&lt;gyroscopeTurnOnBiasSigma&gt;</span>0.0087<span class="tag">&lt;/gyroscopeTurnOnBiasSigma&gt;</span>
  
  <span class="comment">&lt;!-- 가속도계 노이즈 파라미터 --&gt;</span>
  <span class="tag">&lt;accelerometerNoiseDensity&gt;</span>0.00186<span class="tag">&lt;/accelerometerNoiseDensity&gt;</span>
  <span class="tag">&lt;accelerometerRandomWalk&gt;</span>0.006<span class="tag">&lt;/accelerometerRandomWalk&gt;</span>
  <span class="tag">&lt;accelerometerBiasCorrelationTime&gt;</span>300.0<span class="tag">&lt;/accelerometerBiasCorrelationTime&gt;</span>
  <span class="tag">&lt;accelerometerTurnOnBiasSigma&gt;</span>0.196<span class="tag">&lt;/accelerometerTurnOnBiasSigma&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>

            <h4>노이즈 파라미터 설명</h4>
            <table>
                <thead>
                    <tr>
                        <th>파라미터</th>
                        <th>설명</th>
                        <th>단위</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>NoiseDensity</code></td>
                        <td>백색 노이즈 밀도 (σ)</td>
                        <td>rad/s/√Hz 또는 m/s²/√Hz</td>
                    </tr>
                    <tr>
                        <td><code>RandomWalk</code></td>
                        <td>바이어스 드리프트 (랜덤 워크)</td>
                        <td>rad/s²/√Hz 또는 m/s³/√Hz</td>
                    </tr>
                    <tr>
                        <td><code>BiasCorrelationTime</code></td>
                        <td>바이어스 상관 시간</td>
                        <td>초 (s)</td>
                    </tr>
                    <tr>
                        <td><code>TurnOnBiasSigma</code></td>
                        <td>시작 시 바이어스 표준편차</td>
                        <td>rad/s 또는 m/s²</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Section 6: Rotors -->
        <section id="rotors">
            <h2>06. 로터 시스템</h2>

            <p>Iris는 4개의 로터를 가진 쿼드콥터입니다. 각 로터는 개별 링크로 정의되며, 모터 플러그인이 물리적 특성을 시뮬레이션합니다.</p>

            <h3>로터 링크 정의</h3>
            <pre><code><span class="tag">&lt;link</span> <span class="attr">name</span>=<span class="value">'rotor_0'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;pose&gt;</span>0.13 -0.22 0.023 0 0 0<span class="tag">&lt;/pose&gt;</span>  <span class="comment">&lt;!-- 우측 전방 --&gt;</span>
  <span class="tag">&lt;inertial&gt;</span>
    <span class="tag">&lt;mass&gt;</span>0.005<span class="tag">&lt;/mass&gt;</span>  <span class="comment">&lt;!-- 5g --&gt;</span>
    <span class="tag">&lt;inertia&gt;</span>
      <span class="tag">&lt;ixx&gt;</span>9.75e-07<span class="tag">&lt;/ixx&gt;</span>      <span class="comment">&lt;!-- 회전축 관성 (작음) --&gt;</span>
      <span class="tag">&lt;iyy&gt;</span>0.000273104<span class="tag">&lt;/iyy&gt;</span>  <span class="comment">&lt;!-- 프로펠러 면 관성 --&gt;</span>
      <span class="tag">&lt;izz&gt;</span>0.000274004<span class="tag">&lt;/izz&gt;</span>  <span class="comment">&lt;!-- 프로펠러 면 관성 --&gt;</span>
    <span class="tag">&lt;/inertia&gt;</span>
  <span class="tag">&lt;/inertial&gt;</span>
  <span class="tag">&lt;collision&gt;</span>
    <span class="tag">&lt;geometry&gt;</span>
      <span class="tag">&lt;cylinder&gt;</span>
        <span class="tag">&lt;length&gt;</span>0.005<span class="tag">&lt;/length&gt;</span>    <span class="comment">&lt;!-- 두께 5mm --&gt;</span>
        <span class="tag">&lt;radius&gt;</span>0.128<span class="tag">&lt;/radius&gt;</span>    <span class="comment">&lt;!-- 반지름 12.8cm --&gt;</span>
      <span class="tag">&lt;/cylinder&gt;</span>
    <span class="tag">&lt;/geometry&gt;</span>
  <span class="tag">&lt;/collision&gt;</span>
<span class="tag">&lt;/link&gt;</span></code></pre>

            <h4>4개 로터 위치 및 특성</h4>
            <table>
                <thead>
                    <tr>
                        <th>로터</th>
                        <th>위치 (X, Y, Z) [m]</th>
                        <th>회전 방향</th>
                        <th>프로펠러</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>rotor_0 (우측 전방)</td>
                        <td>(0.13, -0.22, 0.023)</td>
                        <td>CCW (반시계)</td>
                        <td>iris_prop_ccw.dae</td>
                    </tr>
                    <tr>
                        <td>rotor_1 (좌측 후방)</td>
                        <td>(-0.13, 0.20, 0.023)</td>
                        <td>CCW (반시계)</td>
                        <td>iris_prop_ccw.dae</td>
                    </tr>
                    <tr>
                        <td>rotor_2 (좌측 전방)</td>
                        <td>(0.13, 0.22, 0.023)</td>
                        <td>CW (시계)</td>
                        <td>iris_prop_cw.dae</td>
                    </tr>
                    <tr>
                        <td>rotor_3 (우측 후방)</td>
                        <td>(-0.13, -0.20, 0.023)</td>
                        <td>CW (시계)</td>
                        <td>iris_prop_cw.dae</td>
                    </tr>
                </tbody>
            </table>

            <h3>로터 조인트</h3>
            <pre><code><span class="tag">&lt;joint</span> <span class="attr">name</span>=<span class="value">'rotor_0_joint'</span> <span class="attr">type</span>=<span class="value">'revolute'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;child&gt;</span>rotor_0<span class="tag">&lt;/child&gt;</span>
  <span class="tag">&lt;parent&gt;</span>base_link<span class="tag">&lt;/parent&gt;</span>
  <span class="tag">&lt;axis&gt;</span>
    <span class="tag">&lt;xyz&gt;</span>0 0 1<span class="tag">&lt;/xyz&gt;</span>  <span class="comment">&lt;!-- Z축 (위쪽) 기준 회전 --&gt;</span>
    <span class="tag">&lt;limit&gt;</span>
      <span class="tag">&lt;lower&gt;</span>-1e+16<span class="tag">&lt;/lower&gt;</span>  <span class="comment">&lt;!-- 무한 회전 허용 --&gt;</span>
      <span class="tag">&lt;upper&gt;</span>1e+16<span class="tag">&lt;/upper&gt;</span>
    <span class="tag">&lt;/limit&gt;</span>
  <span class="tag">&lt;/axis&gt;</span>
<span class="tag">&lt;/joint&gt;</span></code></pre>

            <div class="info-box concept">
                <div class="info-box-title">왜 continuous가 아닌 revolute?</div>
                <p>SDF에서는 <code>revolute</code> 조인트에 매우 큰 limit (±10<sup>16</sup>)을 설정하여 실질적인 무한 회전을 구현합니다.</p>
                <p>URDF의 <code>continuous</code>와 동일한 효과를 냅니다.</p>
            </div>
        </section>

        <!-- Section 7: Plugins -->
        <section id="plugins">
            <h2>07. Gazebo 플러그인</h2>

            <p>플러그인은 Gazebo의 기능을 확장하여 모터 물리, 센서 시뮬레이션, 통신 인터페이스 등을 구현합니다.</p>

            <div id="motor-plugin">
                <h3>모터 모델 플러그인</h3>

                <pre><code><span class="tag">&lt;plugin</span> <span class="attr">name</span>=<span class="value">'front_right_motor_model'</span> <span class="attr">filename</span>=<span class="value">'libgazebo_motor_model.so'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;jointName&gt;</span>rotor_0_joint<span class="tag">&lt;/jointName&gt;</span>
  <span class="tag">&lt;linkName&gt;</span>rotor_0<span class="tag">&lt;/linkName&gt;</span>
  <span class="tag">&lt;turningDirection&gt;</span>ccw<span class="tag">&lt;/turningDirection&gt;</span>      <span class="comment">&lt;!-- 반시계 방향 --&gt;</span>
  
  <span class="comment">&lt;!-- 모터 동역학 --&gt;</span>
  <span class="tag">&lt;timeConstantUp&gt;</span>0.0125<span class="tag">&lt;/timeConstantUp&gt;</span>      <span class="comment">&lt;!-- 가속 시정수 [s] --&gt;</span>
  <span class="tag">&lt;timeConstantDown&gt;</span>0.025<span class="tag">&lt;/timeConstantDown&gt;</span>  <span class="comment">&lt;!-- 감속 시정수 [s] --&gt;</span>
  <span class="tag">&lt;maxRotVelocity&gt;</span>1100<span class="tag">&lt;/maxRotVelocity&gt;</span>      <span class="comment">&lt;!-- 최대 회전 속도 [rad/s] --&gt;</span>
  
  <span class="comment">&lt;!-- 추력 및 토크 계수 --&gt;</span>
  <span class="tag">&lt;motorConstant&gt;</span>5.84e-06<span class="tag">&lt;/motorConstant&gt;</span>    <span class="comment">&lt;!-- k_f: 추력 계수 --&gt;</span>
  <span class="tag">&lt;momentConstant&gt;</span>0.06<span class="tag">&lt;/momentConstant&gt;</span>    <span class="comment">&lt;!-- k_m: 모멘트 계수 --&gt;</span>
  
  <span class="comment">&lt;!-- 공기역학적 효과 --&gt;</span>
  <span class="tag">&lt;rotorDragCoefficient&gt;</span>0.000175<span class="tag">&lt;/rotorDragCoefficient&gt;</span>
  <span class="tag">&lt;rollingMomentCoefficient&gt;</span>1e-06<span class="tag">&lt;/rollingMomentCoefficient&gt;</span>
  
  <span class="comment">&lt;!-- 통신 --&gt;</span>
  <span class="tag">&lt;motorNumber&gt;</span>0<span class="tag">&lt;/motorNumber&gt;</span>
  <span class="tag">&lt;commandSubTopic&gt;</span>/gazebo/command/motor_speed<span class="tag">&lt;/commandSubTopic&gt;</span>
  <span class="tag">&lt;motorSpeedPubTopic&gt;</span>/motor_speed/0<span class="tag">&lt;/motorSpeedPubTopic&gt;</span>
  
  <span class="tag">&lt;rotorVelocitySlowdownSim&gt;</span>10<span class="tag">&lt;/rotorVelocitySlowdownSim&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>

                <h4>모터 물리 모델</h4>
                <div class="formula">
                    추력: F = k<sub>f</sub> × ω²
                    <br><br>
                    반작용 토크: M = k<sub>m</sub> × F = k<sub>m</sub> × k<sub>f</sub> × ω²
                    <div class="formula-label">ω: 로터 각속도 [rad/s], k<sub>f</sub> = 5.84×10⁻⁶, k<sub>m</sub> = 0.06</div>
                </div>

                <h4>모터 파라미터 설명</h4>
                <div class="param-list">
                    <div class="param-item">
                        <span class="param-name">timeConstantUp</span>
                        <span class="param-type">0.0125 s</span>
                        <span class="param-desc">모터 가속 시 1차 시스템 시정수. 63%까지 도달 시간</span>
                    </div>
                    <div class="param-item">
                        <span class="param-name">timeConstantDown</span>
                        <span class="param-type">0.025 s</span>
                        <span class="param-desc">모터 감속 시정수. 가속보다 느림 (관성 + 드래그)</span>
                    </div>
                    <div class="param-item">
                        <span class="param-name">maxRotVelocity</span>
                        <span class="param-type">1100 rad/s</span>
                        <span class="param-desc">≈ 10,500 RPM. 최대 회전 속도</span>
                    </div>
                    <div class="param-item">
                        <span class="param-name">motorConstant</span>
                        <span class="param-type">5.84e-6</span>
                        <span class="param-desc">추력 계수 k<sub>f</sub>. F = k<sub>f</sub> × ω² [N]</span>
                    </div>
                    <div class="param-item">
                        <span class="param-name">momentConstant</span>
                        <span class="param-type">0.06</span>
                        <span class="param-desc">토크/추력 비율. M = k<sub>m</sub> × F</span>
                    </div>
                    <div class="param-item">
                        <span class="param-name">rotorDragCoefficient</span>
                        <span class="param-type">1.75e-4</span>
                        <span class="param-desc">로터 항력 계수. 이동 시 추가 항력</span>
                    </div>
                    <div class="param-item">
                        <span class="param-name">rotorVelocitySlowdownSim</span>
                        <span class="param-type">10</span>
                        <span class="param-desc">시뮬레이션 시각화용 속도 감소 비율</span>
                    </div>
                </div>

                <div class="info-box tip">
                    <div class="info-box-title">최대 추력 계산</div>
                    <p>F<sub>max</sub> = k<sub>f</sub> × ω<sub>max</sub>² = 5.84×10⁻⁶ × 1100² ≈ <strong>7.06 N</strong></p>
                    <p>4개 로터 총 추력: 7.06 × 4 = <strong>28.24 N</strong></p>
                    <p>드론 무게: 1.5 kg × 9.81 = <strong>14.7 N</strong></p>
                    <p>추력/무게 비율: 28.24 / 14.7 ≈ <strong>1.92</strong> (충분한 여유)</p>
                </div>
            </div>

            <div id="sensor-plugins">
                <h3>센서 플러그인</h3>

                <h4>자력계 (Magnetometer)</h4>
                <pre><code><span class="tag">&lt;plugin</span> <span class="attr">name</span>=<span class="value">'magnetometer_plugin'</span> <span class="attr">filename</span>=<span class="value">'libgazebo_magnetometer_plugin.so'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;pubRate&gt;</span>100<span class="tag">&lt;/pubRate&gt;</span>             <span class="comment">&lt;!-- 발행 주기 [Hz] --&gt;</span>
  <span class="tag">&lt;noiseDensity&gt;</span>0.0004<span class="tag">&lt;/noiseDensity&gt;</span>  <span class="comment">&lt;!-- 노이즈 밀도 --&gt;</span>
  <span class="tag">&lt;randomWalk&gt;</span>6.4e-06<span class="tag">&lt;/randomWalk&gt;</span>    <span class="comment">&lt;!-- 랜덤 워크 --&gt;</span>
  <span class="tag">&lt;biasCorrelationTime&gt;</span>600<span class="tag">&lt;/biasCorrelationTime&gt;</span>
  <span class="tag">&lt;magTopic&gt;</span>/mag<span class="tag">&lt;/magTopic&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>

                <h4>기압계 (Barometer)</h4>
                <pre><code><span class="tag">&lt;plugin</span> <span class="attr">name</span>=<span class="value">'barometer_plugin'</span> <span class="attr">filename</span>=<span class="value">'libgazebo_barometer_plugin.so'</span><span class="tag">&gt;</span>
  <span class="tag">&lt;pubRate&gt;</span>50<span class="tag">&lt;/pubRate&gt;</span>            <span class="comment">&lt;!-- 발행 주기 [Hz] --&gt;</span>
  <span class="tag">&lt;baroTopic&gt;</span>/baro<span class="tag">&lt;/baroTopic&gt;</span>
  <span class="tag">&lt;baroDriftPaPerSec&gt;</span>0<span class="tag">&lt;/baroDriftPaPerSec&gt;</span>  <span class="comment">&lt;!-- 압력 드리프트 --&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>

                <h4>Ground Truth</h4>
                <pre><code><span class="tag">&lt;plugin</span> <span class="attr">name</span>=<span class="value">'groundtruth_plugin'</span> <span class="attr">filename</span>=<span class="value">'libgazebo_groundtruth_plugin.so'</span><span class="tag">&gt;</span>
  <span class="comment">&lt;!-- 시뮬레이터의 실제 위치/자세 제공 (노이즈 없음) --&gt;</span>
  <span class="comment">&lt;!-- 알고리즘 검증 및 디버깅용 --&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>

                <h4>센서 비교 요약</h4>
                <table>
                    <thead>
                        <tr>
                            <th>센서</th>
                            <th>주기</th>
                            <th>측정값</th>
                            <th>용도</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>IMU</td>
                            <td>-</td>
                            <td>가속도, 각속도</td>
                            <td>자세 추정</td>
                        </tr>
                        <tr>
                            <td>자력계</td>
                            <td>100 Hz</td>
                            <td>자기장 벡터</td>
                            <td>Yaw 추정 (나침반)</td>
                        </tr>
                        <tr>
                            <td>기압계</td>
                            <td>50 Hz</td>
                            <td>기압</td>
                            <td>고도 추정</td>
                        </tr>
                        <tr>
                            <td>GPS</td>
                            <td>-</td>
                            <td>위도, 경도, 고도</td>
                            <td>절대 위치</td>
                        </tr>
                        <tr>
                            <td>Ground Truth</td>
                            <td>-</td>
                            <td>실제 상태</td>
                            <td>디버깅</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="mavlink-plugin">
                <h3>MAVLink 인터페이스</h3>

                <p>MAVLink는 드론과 지상국/컴패니언 컴퓨터 간 통신 프로토콜입니다. 이 플러그인이 PX4 SITL과 Gazebo를 연결합니다.</p>

                <pre><code><span class="tag">&lt;plugin</span> <span class="attr">name</span>=<span class="value">'mavlink_interface'</span> <span class="attr">filename</span>=<span class="value">'libgazebo_mavlink_interface.so'</span><span class="tag">&gt;</span>
  <span class="comment">&lt;!-- 센서 토픽 구독 --&gt;</span>
  <span class="tag">&lt;imuSubTopic&gt;</span>/imu<span class="tag">&lt;/imuSubTopic&gt;</span>
  <span class="tag">&lt;magSubTopic&gt;</span>/mag<span class="tag">&lt;/magSubTopic&gt;</span>
  <span class="tag">&lt;baroSubTopic&gt;</span>/baro<span class="tag">&lt;/baroSubTopic&gt;</span>
  
  <span class="comment">&lt;!-- 네트워크 설정 --&gt;</span>
  <span class="tag">&lt;mavlink_addr&gt;</span>INADDR_ANY<span class="tag">&lt;/mavlink_addr&gt;</span>
  <span class="tag">&lt;mavlink_tcp_port&gt;</span>4560<span class="tag">&lt;/mavlink_tcp_port&gt;</span>   <span class="comment">&lt;!-- PX4 연결 --&gt;</span>
  <span class="tag">&lt;mavlink_udp_port&gt;</span>14560<span class="tag">&lt;/mavlink_udp_port&gt;</span>
  
  <span class="comment">&lt;!-- QGroundControl 연결 --&gt;</span>
  <span class="tag">&lt;qgc_addr&gt;</span>INADDR_ANY<span class="tag">&lt;/qgc_addr&gt;</span>
  <span class="tag">&lt;qgc_udp_port&gt;</span>14550<span class="tag">&lt;/qgc_udp_port&gt;</span>
  
  <span class="comment">&lt;!-- SDK 연결 (MAVSDK 등) --&gt;</span>
  <span class="tag">&lt;sdk_addr&gt;</span>INADDR_ANY<span class="tag">&lt;/sdk_addr&gt;</span>
  <span class="tag">&lt;sdk_udp_port&gt;</span>14540<span class="tag">&lt;/sdk_udp_port&gt;</span>
  
  <span class="comment">&lt;!-- 시뮬레이션 모드 --&gt;</span>
  <span class="tag">&lt;hil_mode&gt;</span>0<span class="tag">&lt;/hil_mode&gt;</span>              <span class="comment">&lt;!-- SITL 모드 --&gt;</span>
  <span class="tag">&lt;enable_lockstep&gt;</span>1<span class="tag">&lt;/enable_lockstep&gt;</span>  <span class="comment">&lt;!-- 동기화 활성화 --&gt;</span>
  <span class="tag">&lt;use_tcp&gt;</span>1<span class="tag">&lt;/use_tcp&gt;</span>              <span class="comment">&lt;!-- TCP 사용 --&gt;</span>
  
  <span class="comment">&lt;!-- 데이터 전송 설정 --&gt;</span>
  <span class="tag">&lt;send_vision_estimation&gt;</span>0<span class="tag">&lt;/send_vision_estimation&gt;</span>
  <span class="tag">&lt;send_odometry&gt;</span>1<span class="tag">&lt;/send_odometry&gt;</span>
  
  <span class="comment">&lt;!-- 모터 명령 발행 --&gt;</span>
  <span class="tag">&lt;motorSpeedCommandPubTopic&gt;</span>/gazebo/command/motor_speed<span class="tag">&lt;/motorSpeedCommandPubTopic&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>

                <div class="diagram">
<div class="diagram-title">SITL 통신 아키텍처</div>
┌─────────────────────────────────────────────────────────────────┐
│                         시뮬레이션 시스템                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────────┐         TCP:4560         ┌─────────────┐     │
│   │             │◀────────────────────────▶│             │     │
│   │   Gazebo    │   센서 데이터 / 모터 명령  │  PX4 SITL   │     │
│   │  + 플러그인  │                          │  (px4.exe)  │     │
│   │             │                          │             │     │
│   └──────┬──────┘                          └──────┬──────┘     │
│          │                                        │             │
│          │ ROS 토픽                               │ MAVLink     │
│          ▼                                        ▼             │
│   ┌─────────────┐                          ┌─────────────┐     │
│   │   ROS 노드   │                          │ QGround-    │     │
│   │ (드론 제어)  │◀─────UDP:14540──────────▶│ Control     │     │
│   │             │      MAVSDK              │ UDP:14550   │     │
│   └─────────────┘                          └─────────────┘     │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘</div>

                <h4>주요 포트 정리</h4>
                <table>
                    <thead>
                        <tr>
                            <th>포트</th>
                            <th>프로토콜</th>
                            <th>연결 대상</th>
                            <th>용도</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>4560</td>
                            <td>TCP</td>
                            <td>PX4 SITL</td>
                            <td>시뮬레이터 ↔ 펌웨어</td>
                        </tr>
                        <tr>
                            <td>14560</td>
                            <td>UDP</td>
                            <td>PX4 (대체)</td>
                            <td>UDP 연결 옵션</td>
                        </tr>
                        <tr>
                            <td>14550</td>
                            <td>UDP</td>
                            <td>QGroundControl</td>
                            <td>지상국 연결</td>
                        </tr>
                        <tr>
                            <td>14540</td>
                            <td>UDP</td>
                            <td>MAVSDK/MAVROS</td>
                            <td>SDK/ROS 연결</td>
                        </tr>
                    </tbody>
                </table>

                <div class="info-box concept">
                    <div class="info-box-title">Lockstep 동기화</div>
                    <p><code>enable_lockstep=1</code>: Gazebo와 PX4가 동기화되어 실행됩니다.</p>
                    <p><strong>장점</strong>: 재현 가능한 시뮬레이션, 디버깅 용이</p>
                    <p><strong>단점</strong>: 실시간보다 느릴 수 있음</p>
                </div>
            </div>
        </section>

        <!-- Section 8: Physics -->
        <section id="physics">
            <h2>08. 물리 파라미터 해석</h2>

            <h3>관성 모멘트 비교</h3>
            <table>
                <thead>
                    <tr>
                        <th>링크</th>
                        <th>질량 [kg]</th>
                        <th>I<sub>xx</sub> [kg·m²]</th>
                        <th>I<sub>yy</sub></th>
                        <th>I<sub>zz</sub></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>base_link (본체)</td>
                        <td>1.5</td>
                        <td>0.029125</td>
                        <td>0.029125</td>
                        <td>0.055225</td>
                    </tr>
                    <tr>
                        <td>fpv_cam_link</td>
                        <td>0.015</td>
                        <td>4.15e-6</td>
                        <td>2.407e-6</td>
                        <td>2.407e-6</td>
                    </tr>
                    <tr>
                        <td>imu_link</td>
                        <td>0.015</td>
                        <td>1e-5</td>
                        <td>1e-5</td>
                        <td>1e-5</td>
                    </tr>
                    <tr>
                        <td>rotor_n (각각)</td>
                        <td>0.005</td>
                        <td>9.75e-7</td>
                        <td>2.73e-4</td>
                        <td>2.74e-4</td>
                    </tr>
                </tbody>
            </table>

            <h3>총 시스템 질량</h3>
            <div class="formula">
                M<sub>total</sub> = M<sub>base</sub> + M<sub>cam</sub> + M<sub>imu</sub> + 4 × M<sub>rotor</sub>
                <br><br>
                = 1.5 + 0.015 + 0.015 + 4 × 0.005 = <strong>1.55 kg</strong>
            </div>

            <h3>추력-무게 비율 분석</h3>
            <div class="grid-2">
                <div>
                    <h5>호버링 조건</h5>
                    <p>총 추력 = 무게</p>
                    <p>4 × k<sub>f</sub> × ω² = M × g</p>
                    <p>ω<sub>hover</sub> = √(Mg / 4k<sub>f</sub>)</p>
                    <p>= √(1.55 × 9.81 / 4 × 5.84e-6)</p>
                    <p>≈ <strong>806 rad/s</strong> (≈ 7700 RPM)</p>
                </div>
                <div>
                    <h5>최대 가속도</h5>
                    <p>F<sub>max</sub> = 4 × k<sub>f</sub> × ω<sub>max</sub>²</p>
                    <p>= 4 × 5.84e-6 × 1100²</p>
                    <p>≈ 28.24 N</p>
                    <p>a<sub>max</sub> = (F<sub>max</sub> - Mg) / M</p>
                    <p>≈ <strong>8.4 m/s²</strong> (상승)</p>
                </div>
            </div>

            <h3>동역학 파라미터 요약</h3>
            <div class="info-box tip">
                <div class="info-box-title">시뮬레이션 파라미터 해석</div>
                <ul style="margin: 0; padding-left: 20px;">
                    <li><strong>호버링 RPM</strong>: ~7700 RPM (최대의 70%)</li>
                    <li><strong>추력/무게 비율</strong>: ~1.86 (충분한 기동성)</li>
                    <li><strong>모터 응답</strong>: 가속 12.5ms, 감속 25ms</li>
                    <li><strong>Yaw 관성 비율</strong>: I<sub>zz</sub>/I<sub>xx</sub> ≈ 1.9 (Yaw가 Roll/Pitch보다 느림)</li>
                </ul>
            </div>
        </section>

        <footer>
            <p>Iris 쿼드콥터 SDF 모델 분석 문서</p>
            <p>Gazebo + PX4 SITL 시뮬레이션 환경</p>
        </footer>
    </div>
</body>
</html>
